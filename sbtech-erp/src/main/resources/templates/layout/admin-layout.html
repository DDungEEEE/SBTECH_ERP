<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ERP ê´€ë¦¬ì ì‹œìŠ¤í…œ</title>

    <style>
        body {
            margin: 0;
            display: flex;
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f5f7fa;
        }

        .sidebar {
            width: 240px;
            background-color: #1e2a3a;

            position: sticky;
            top: 0;

            min-height: 100vh;    /* ğŸ”¹ ì „ì²´ í™”ë©´ë³´ë‹¤ ì‘ì§€ ì•Šê²Œ */
            height: auto;         /* ğŸ”¹ ì½˜í…ì¸ ê°€ ê¸¸ë©´ ìë™ìœ¼ë¡œ ëŠ˜ì–´ë‚¨ */

            display: flex;
            flex-direction: column;
        }
        .sidebar.collapsed {
            width: 60px;
        }

        .toggle-sidebar-btn {
            font-size: 20px;
            color: white;
            cursor: pointer;
            padding: 10px 15px;
            display: inline-block;
        }

        .logo {
            text-align: center;
            font-size: 22px;
            margin-bottom: 25px;
            white-space: nowrap;
        }

        .logo span {
            color: #4f83ff;
            font-weight: bold;
        }

        .menu {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .menu-item > a {
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-decoration: none;
            padding: 12px 18px;
            font-size: 15px;
            color: #b8c7ce;
            transition: 0.2s;
            cursor: pointer;
            white-space: nowrap;
        }

        .sidebar.collapsed .menu-item > a span.text {
            display: none;
        }

        .sidebar.collapsed .arrow {
            display: none;
        }

        .menu-item:hover > a,
        .menu-item.active > a {
            background-color: #4f83ff;
            color: white;
            border-radius: 4px;
        }

        .arrow {
            font-size: 13px;
        }

        .submenu {
            display: none;
            background: #273447;
        }

        .submenu li a {
            padding: 10px 35px;
            display: block;
            text-decoration: none;
            color: #cdd9e5;
            font-size: 14px;
            transition: 0.2s;
        }

        .submenu li a:hover {
            background-color: #4f83ff;
            color: white;
        }

        .content {
            flex: 1;
            padding: 20px;
        }

        .logout-btn {
            margin-top: auto;
            padding: 12px 20px;
            color: #cbd5e1; /* ì‚¬ì´ë“œë°” ê¸°ë³¸ ê¸€ì”¨ìƒ‰ê³¼ ë™ì¼ */
            text-decoration: none;
            display: block;
            font-size: 15px;
            transition: 0.2s;
        }

        .logout-btn:hover {
            background-color: #2563eb; /* ë©”ë‰´ hoverì™€ ë™ì¼ */
            color: white;
            border-radius: 6px;
        }
    </style>

    <th:block th:if="${pageName == 'employee-management'}">
        <link rel="stylesheet" th:href="@{/css/employee-management.css}">
    </th:block>

    <th:block th:if="${pageName == 'task-management'}">
        <link rel="stylesheet" th:href="@{/css/task-management.css}">
    </th:block>
    <th:block th:if="${pageName == 'inventory'}">
        <link rel="stylesheet" th:href="@{/css/inventory.css}">
    </th:block>

    <th:block th:if="${pageName == 'inventory-inout'}">
        <link rel="stylesheet" th:href="@{/css/inventory-inout.css}">
    </th:block>

    <th:block th:if="${pageName == 'journal'}">
        <link rel="stylesheet" th:href="@{/css/journal.css}">
    </th:block>

</head>

<body>

<!-- âœ… Sidebar -->
<div class="sidebar" id="sidebar">
    <div class="toggle-sidebar-btn" id="toggleBtn">â˜°</div>

    <h2 class="logo"><span>ERP</span> System</h2>

    <ul class="menu">

        <li class="menu-item"><a th:href="@{/web/admin}"><span class="text">ëŒ€ì‹œë³´ë“œ</span></a></li>

        <li class="menu-item has-sub">
            <a class="toggle-btn"><span class="text">ì‚¬ì› ê´€ë¦¬</span> <span class="arrow">â–¶</span></a>
            <ul class="submenu">
                <li><a href="/web/admin/employee-management">ì‚¬ì› ëª©ë¡</a></li>
            </ul>
        </li>

        <li class="menu-item has-sub">
            <a class="toggle-btn"><span class="text">ì—…ë¬´ ê´€ë¦¬</span> <span class="arrow">â–¶</span></a>
            <ul class="submenu">
                <li><a th:href="@{/web/admin/task-management}">ì—…ë¬´ í˜„í™©</a></li>
            </ul>
        </li>

        <li class="menu-item has-sub">
            <a class="toggle-btn"><span class="text">íšŒê³„ ê´€ë¦¬</span> <span class="arrow">â–¶</span></a>
            <ul class="submenu">
                <li><a th:href="@{/web/admin/journal}">ì „í‘œ ê´€ë¦¬</a></li>
                <li><a href="#" onclick="downloadJournalExcel()">ë³´ê³ ì„œ ë‹¤ìš´ë¡œë“œ</a></li>
            </ul>
        </li>

        <li class="menu-item has-sub">
            <a class="toggle-btn"><span class="text">ì¬ê³  ê´€ë¦¬</span> <span class="arrow">â–¶</span></a>
            <ul class="submenu">
                <li><a th:href="@{/web/admin/inventory}">ì¬ê³  í˜„í™©</a></li>
                <li><a th:href="@{/web/admin/inventory-inout}">ì…Â·ì¶œê³  ê´€ë¦¬</a></li>
            </ul>
        </li>

        <li class="menu-item"><a href="#"><span class="text">ë³´ê³ ì„œ</span></a></li>
        <a href="/web/login" id="logoutBtn" class="logout-btn">ë¡œê·¸ì•„ì›ƒ</a>
    </ul>
</div>

<!-- âœ… Content -->
<div class="content">
    <th:block th:replace="~{${content} :: content}"></th:block>
</div>


<!-- âœ… Scripts -->
<script>
    // ì„œë¸Œë©”ë‰´ í† ê¸€
    document.querySelectorAll(".has-sub .toggle-btn").forEach(button => {
        button.addEventListener("click", () => {
            const submenu = button.nextElementSibling;
            const arrow = button.querySelector(".arrow");

            submenu.style.display = submenu.style.display === "block" ? "none" : "block";
            arrow.textContent = arrow.textContent === "â–¶" ? "â–¼" : "â–¶";
        });
    });

    // ì „ì²´ ì‚¬ì´ë“œë°” í† ê¸€
    const sidebar = document.getElementById("sidebar");
    const toggleBtn = document.getElementById("toggleBtn");

    toggleBtn.addEventListener("click", () => {
        sidebar.classList.toggle("collapsed");
    });


</script>
<script>
    function downloadJournalExcel() {
        const token = localStorage.getItem("accessToken");

        fetch("/erp/api/v1/journal-entry/excel", {
            method: "GET",
            headers: {
                "Authorization": `Bearer ${token}`
            }
        })
            .then(res => res.blob())
            .then(blob => {
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = "journal_report.xlsx";   // ğŸ”¥ íŒŒì¼ëª…
                document.body.appendChild(a);
                a.click();
                a.remove();
            });
    }
</script>

<!--<script th:if="${pageName == 'employee-management'}"-->
<!--        src="/js/admin/employee-management.js">-->
<!--</script>-->
</body>
</html>
