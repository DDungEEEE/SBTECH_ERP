<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<th:block th:fragment="content">

    <h1 class="page-title">ë‚´ ì£¼ë¬¸</h1>

    <!-- ğŸ”¹ ê²€ìƒ‰ + ë‚ ì§œ í•„í„° -->
    <div class="order-filters">
        <input type="text" id="searchInput" placeholder="ê±°ë˜ì²˜ ì´ë¦„ ê²€ìƒ‰ (ì˜ˆ: ìˆ˜ì›ì )" />

        <div class="date-range">
            <input type="date" id="startDate" />
            <span>~</span>
            <input type="date" id="endDate" />
        </div>

        <button class="quick-btn" data-type="today">ìµœê·¼ 1ì¼</button>
        <button class="quick-btn" data-type="week">ìµœê·¼ 1ì£¼ì¼</button>
        <button class="quick-btn" data-type="month">ìµœê·¼ 1ê°œì›”</button>
        <button class="quick-btn" data-type="3month">ìµœê·¼ 3ê°œì›”</button>
    </div>

    <!-- ğŸ”¹ ì£¼ë¬¸ ëª©ë¡ -->
    <div class="order-list-container">
        <div class="order-title">
            ì£¼ë¬¸ ëª©ë¡ (ì´ <span id="orderCount">0</span>ê±´)
        </div>

        <table class="order-table">
            <thead>
            <tr>
                <th>ì£¼ë¬¸ë²ˆí˜¸</th>
                <th>ê³ ê°ì‚¬</th>
                <th>ìƒí’ˆ</th>
                <th>ê¸ˆì•¡</th>
                <th>ë‚ ì§œ</th>
                <th>ìƒíƒœ</th>
            </tr>
            </thead>
            <tbody id="orderBody"></tbody>
        </table>
    </div>

    <!-- ğŸ”¹ JS (ê°€ë¼ ë°ì´í„° + í™”ë©´ ë Œë”ë§) -->
    <script>
        let originalOrders = [];

        document.addEventListener("DOMContentLoaded", () => {

            // ============================================
            // ğŸ”¹ ê°€ë¼ ì£¼ë¬¸ ë°ì´í„° (ë”ë¯¸)
            // ============================================
            originalOrders = [
                { no: "ORD-145", store: "ë°°í„°ë¦¬í”„ë Œì¦ˆ ìˆ˜ì›ì ", product: "DF1000 10ê°œ", amount: 500000, date: "2025-11-01", status: "ì™„ë£Œ" },
                { no: "ORD-152", store: "ë°°í„°ë¦¬í”„ë Œì¦ˆ ì°½í¬ì ", product: "ì‚°ì—…ìš©ë°°í„°ë¦¬ 20ê°œ", amount: 7900000, date: "2025-10-20", status: "ì§„í–‰ì¤‘" },
                { no: "ORD-164", store: "ë°°í„°ë¦¬í”„ë Œì¦ˆ ì „í¬ì ", product: "ESSëª¨ë“ˆ 30ê°œ", amount: 15000000, date: "2025-10-22", status: "ì™„ë£Œ" },
                { no: "ORD-168", store: "ë°°í„°ë¦¬í”„ë Œì¦ˆ ìˆ˜ì›ì ", product: "ë°°í„°ë¦¬íŒ© 40ê°œ", amount: 600000, date: "2025-10-25", status: "ì™„ë£Œ" },
                { no: "ORD-169", store: "ë°°í„°ë¦¬í”„ë Œì¦ˆ ëª©í¬ì ", product: "ESSëª¨ë“ˆ 50ê°œ", amount: 11300000, date: "2025-10-20", status: "ëŒ€ê¸°" },
                { no: "ORD-178", store: "ë°°í„°ë¦¬í”„ë Œì¦ˆ ê´‘ëª…ì ", product: "DF1000 20ê°œ", amount: 5500000, date: "2025-10-27", status: "ëŒ€ê¸°" },
                { no: "ORD-181", store: "ë°°í„°ë¦¬í”„ë Œì¦ˆ íŒêµì ", product: "ë°°í„°ë¦¬íŒ© 30ê°œ", amount: 8800000, date: "2025-10-18", status: "ì™„ë£Œ" },
                { no: "ORD-184", store: "ë°°í„°ë¦¬í”„ë Œì¦ˆ ëª©í¬ì ", product: "ì¶©ì „ëª¨ë“ˆ 40ê°œ", amount: 2500000, date: "2025-10-26", status: "ì™„ë£Œ" },
                { no: "ORD-185", store: "ë°°í„°ë¦¬í”„ë Œì¦ˆ ìˆ˜ì›ì ", product: "XF1200 20ê°œ", amount: 11400000, date: "2025-10-25", status: "ì™„ë£Œ" }
            ];

            renderOrders(originalOrders);

            document.getElementById("searchInput").addEventListener("input", applyFilters);
            document.getElementById("startDate").addEventListener("change", applyFilters);
            document.getElementById("endDate").addEventListener("change", applyFilters);

            document.querySelectorAll(".quick-btn").forEach(btn => {
                btn.addEventListener("click", () => quickFilter(btn.dataset.type));
            });
        });

        // ============================================
        // ğŸ”¹ í•„í„° ì ìš©
        // ============================================
        function applyFilters() {
            const keyword = document.getElementById("searchInput").value.toLowerCase();
            const start = document.getElementById("startDate").value;
            const end = document.getElementById("endDate").value;

            let filtered = originalOrders.filter(o =>
                o.store.toLowerCase().includes(keyword)
            );

            if (start) {
                filtered = filtered.filter(o => new Date(o.date) >= new Date(start));
            }
            if (end) {
                filtered = filtered.filter(o => new Date(o.date) <= new Date(end));
            }

            renderOrders(filtered);
        }

        // ============================================
        // ğŸ”¹ ìµœê·¼ ë‚ ì§œ ë²„íŠ¼ í•„í„°
        // ============================================
        function quickFilter(type) {
            const today = new Date();
            let startDate = new Date();

            if (type === "today") {
                startDate.setDate(today.getDate() - 1);
            } else if (type === "week") {
                startDate.setDate(today.getDate() - 7);
            } else if (type === "month") {
                startDate.setMonth(today.getMonth() - 1);
            } else if (type === "3month") {
                startDate.setMonth(today.getMonth() - 3);
            }

            document.getElementById("startDate").value = formatDate(startDate);
            document.getElementById("endDate").value = formatDate(today);

            applyFilters();
        }

        function formatDate(date) {
            const y = date.getFullYear();
            const m = String(date.getMonth() + 1).padStart(2, "0");
            const d = String(date.getDate()).padStart(2, "0");
            return `${y}-${m}-${d}`;
        }

        // ============================================
        // ğŸ”¹ í…Œì´ë¸” ë Œë”ë§
        // ============================================
        function renderOrders(list) {
            const tbody = document.getElementById("orderBody");
            tbody.innerHTML = "";

            list.forEach(o => {
                tbody.innerHTML += `
                <tr>
                    <td>${o.no}</td>
                    <td>${o.store}</td>
                    <td>${o.product}</td>
                    <td>â‚©${o.amount.toLocaleString()}</td>
                    <td>${o.date}</td>
                    <td>${statusBadge(o.status)}</td>
                </tr>
            `;
            });

            document.getElementById("orderCount").innerText = list.length;
        }

        // ============================================
        // ğŸ”¹ ìƒíƒœ ë±ƒì§€
        // ============================================
        function statusBadge(status) {
            const cls =
                status === "ì™„ë£Œ" ? "done" :
                    status === "ì§„í–‰ì¤‘" ? "progress" :
                        "waiting";

            return `<span class="badge ${cls}">${status}</span>`;
        }
    </script>

</th:block>
</html>
